# 计算机网络 重要概念

## 第一章 概述

* 计算机网络把许多计算机连接在一起，而互联网则把许多网络连接在一起，是网络的网络。因特网是世界上最大的互联网
* internet是通用名词，泛指多个计算机网络互联而成的网络。在这些网络之间的通信协议可以是任意的
* Internet是专用名词，它指当前全球最大的、开放的、由众多网络相互连接而形成的特定计算机网络，采用TCP/IP协议族作为通信规则
* 因特网现在采用存储转发的分组交换技术，以及ISP结构
* 因特网按工作部分可分为核心部分与边缘部分。主机在网络的边缘部分，作用是进行信息处理；路由器在网络的核心部分，作用是按存储转发方式进行分组交换
* 计算机通信是计算机中的进程之间的通信。计算机网络采用的通信方式是C/S方式和P2P方式
* 客户和服务器都是指通信中涉及的两个应用进程。客户是请求方，服务器是服务提供方
* 按作用范围不同，计算机网络分为广域网、城域网、局域网和个人区域网
* 计算机网络最常用的性能指标：速率、带宽、吞吐量、时延、时延带宽积、往返时间和信道利用率
* 网络协议即协议，是为进行网络中的数据交换而建立的规则。计算机网络的各层及其协议的集合，称为网络的体系结构
* 五层协议的体系结构由应用层、运输层、网络层、数据链路层、物理层组成。运输层最重要的协议是传输控制协议TCP和用户数据报协议UDP，而网络层最重要的协议是网际协议IP

## 第二章 物理层

* 物理层的主要任务是确定与传输媒体的接口有关的一些特性
* 一个数据通信系统可以划分为三部分：源系统、传输系统和目的系统；源系统包括源点和发送器；目的系统包括接收器和终点
* 通信的目的是传递消息；数据是运送消息的实体；信号是数据的电气或电磁表现
* 根据信号中代表消息的参数的取值方式不同，信号可分为模拟信号和数字信号；代表数字信号不同离散数值的基本波形称为码元
* 根据双方信息交互方式的不同。通信可以划分为单向通信、双向交替通信和双向同时通信
* 来自信源的信号叫基带信号。信号要在信号上传输需要经过调制。调制有基带调制和带通调制之分。基本的带通调制方法有调幅、调频、调相，还有复杂的带通调制方法，如正交振幅调制
* 要提高数据在信道上的传输速率，可以使用更好的传输媒体，或者先进的调制技术。但数据传输速率不可能总是被任意提高
* 传输媒体分为两大类，导引型传输媒体(双绞线、同轴电缆/光钎)和非导引型传输媒体(无线)
* 常用的信道复用技术有频分复用、时分复用、波分复用、码分复用、统计时分复用
* 最初在数字传输系统中使用的传输标准是脉冲编码调制PCM，现在高速的数字传输系统使用同步光纤网SONET或同步数字系列SDH
* 用户到因特网的带宽接入方法有非对称数字用户线ADSL、光钎同轴混合网HFC和FTTx
* 为了有效利用光钎资源，在光钎干线和用户之间广泛使用无源光网络PON。无源光网络无须配备电源，其长期云庭成本和管理成本都很低。最流行的无源光网络是以太网无源光网络EPON和吉比特无源光网络GPON

## 第三章 数据链路层

(后续补充)
## 第四章 网络层

* TCP/IP体系中网络层向上只提供简单灵活的、无连接的、尽最大努力交付的数据报服务。网络层不提供服务质量的承诺，不保证分组交付的时限，所传送的数组可能出错、丢失、重复和失序。晋城之间的通信的可靠性由运输层负责
* IP网是虚拟的，因为从网络层上看，IP网好像是一个统一的、抽象的网络。IP层抽象的互联网屏蔽了下层网络的复杂细节，使我们能够使用统一的、抽象的IP地址处理主机之间的通信问题
* 在互联网上的交付有两种：在本网络的直接交付和到其他网络的间接交付
* 一个IP地址在整个因特网内是唯一的。分类的IP地址包括A类、B类、C类、D类。
* 分类的IP地址由网络号字段和主机字段组成。网络号字段最前面的类别位指明IP地址的类别
* IP地址是一种分等级的地址结构。IP地址管理机构分配IP时只分配网络号，主机号由单位自行分配。路由器仅根据目的主机所连接的网络号转发分组
* IP地址标志一台主机和一条链路的接口。多归属主机同时连接到两个或更多的网络，这样的主机同时具有具有两个或更多的IP地址，其网络号必须是不同的。由于一个路由器至少应当连接到两个网络，因此一个路由器至少应当有两个不同的IP地址
* 按照因特网的观点，用转发器或者网桥连接起来的若干局域网仍然作为一个网络。所有分配到网络号的网络都是平等的
* 物理地址是数据链路层和物理层使用的地址，而IP地址是网络层及以上各层使用的地址，是一种逻辑地址，在数据链路层看不到数据报的IP地址
* IP数据报分为首部和数据两部分。首部的前一部分是固定长度，共20字节，是所有IP数据报必须具有的，一些可变长度的可选字段放在固定首部的后面
* IP首部中的生存时间字段给出了IP数据报在因特网中所能经过的最大路由数，可防止IP数据报在互联网中无限制的兜圈子
* 地址解析协议ARP把IP地址解析为硬件地址，它解决同一个局域网上的主机或路由器的IP地址和硬件地址的映射问题。ARP的高速缓存可以大大减少网络上的通信量
* 在因特网中，无法根据硬件地址寻找到某个网络上的某台主机，因此从IP地址到硬件地址的解析是非常必要的
* CIDR是解决IP地址紧缺的一个好方法。CIDR记法将IP地址后面加上上斜线，然后写明前缀所占的位数。
CIDR将前缀相同的连续的IP地址组成一个CIDR地址块。IP地址的分配以CIDR块为单位
* CIDR的32位地址掩码由一串0和1组成，而1的个数就是前缀的长度。将IP地址和地址掩码逐位与运算，
很容易得出网络地址。A类地址默认地址掩码`255.0.0.0`,B类地址默认地址掩码`255.255.0.0`,
C类地址默认地址掩码`255.255.255.0`
* 路由聚合(将许多前缀相同的地址用一个来代替)有利于减少路由表中的项目，减少路由器之间的路由器选择信息的交换，从而提高因特网的性能
* 转发和路由选择有区别。`转发`是单个路由的动作。`路由选择`是由许多路由器共同协作的过程，
这些路由器相互交换信息，目的是生成路由表，再从路由表导出转发表。若采用自适应路由选择算法，
则当网络拓扑变化时，路由表和转发表都能自动更新。在许多情况下可以不考虑转发表和路由表的区别
* `自治系统(AS)`就是在单一的技术管理下的一组路由器。一个自治系统对其他自治系统表现出的是一个单一的和一致的路由选择策略
* 路由选择协议有两种：`内部网关协议`，如`RIP`和`OSPF`;`外部网关协议`，如`BGP4`
* `RIP`是分布式的基于距离向量的路由选择协议，只适用于小型网络。RIP按照固定时间间隔与相邻路由器
交换信息。交换的信息是自己当前的路由表
* `OSPF`是分布式的链路状态协议，适用于大型互联网。OSPF只在链路状态发生变化时才用向本自治系统中的
所有路由器，用洪泛法发送与本路由器相邻的所有路由器的链路状态信息。`链路状态`指名本路由器都和
哪些路由器相邻，以及该链路的度量。`度量`可表示费用、距离、时延、带宽等。所有的路由器最终
都能建立一个全网的拓扑结构图
* `BGP4`是不同AS的路由器之间交换路由信息的协议，是一种路径向量路由选择协议。BGP力求寻找
一条能够到达目的网络且比较好的路由而非寻找一条最佳路由
* `ICMP`是网络层的协议。ICMP报文作为IP数据报的数据，加上首部后组成IP数据报发送出去。使用
ICMP并不是为了可靠传输，ICMP允许主机或路由器报告差错情况和提供有关异常情况的报告。ICMP报文
的种类分`ICMP差错报告报文`和`ICMP询问报文`
* ICMP的一个重要应用是`PING`，用来测试两台主机之间的连通性。
* 与单播相比，在一对多通信中，IP多播可以大大节约网络资源。IP多播使用D类IP地址、IGMP和多播路由选择协议
* VPN利用公网的因特网作为本机构各专用网之间的通信载体。VPN内部使用因特网的专用地址。一个VPN
至少要有一个路由器具有合法的全球IP地址，这样才能和本系统的另外一个VPN通过因特网进行通信。
所有通过因特网传送的数据都必须加密
* 使用网络地址转换技术NAT，可以在专用网络内部使用专用IP地址，而仅在连接到因特网的路由器
使用全球Ip地址，这样大大节约了IP地址


## 第五章 运输层

* 运输层提供应用进程之间的逻辑通信，也就是说，运输层之间的通信并不是真正在两个运输层之间
直接传输数据。运输层向应用层屏蔽了下面网络的细节，它使应用进程看见的就是好像在两个运输层
实体之间有一条端到端的逻辑通信信道
* 网络层为主机之间提供逻辑通信，而运输层为应用进程之间提供端到端的逻辑通信
* 运输层有两个主要协议：`UDP`和`TCP`,它们都有复用、复用和检错功能。当运输层采用面向连接的TCP协议时，尽管下面的网络是不可靠的，但这种逻辑通信信道就相当于一条全双工通信的可靠信道。当运输层采用无连接的UDP协议时，这种逻辑通信信道仍然是一条不可靠信道
* 运输层用一个16位端口号来标志一个端口。端口号只具有本地意义，它只是为了标志本计算机应用层中的各个进程在和运输层交互时的层间接口。在因特网的不同计算机中，相同的端口号是没有关联的
* 两台计算机中的进程要相互通信，不仅要知道对方的IP地址，而且要知道对方的端口号
* 运输层的端口号分为服务器使用的端口号(0~1023指派给熟知端口，1024~49151是登记端口号)和客户端暂时使用的端口号
* UDP的主要特点是：无连接；尽最大努力交付；面向报文；无拥塞控制；支持一对一、一对多、多对一和多对多的交互通信；首部开销小
* TCP的主要特点是：面向连接；每条TCP连接只能是一对一的；提供可靠的交付服务；提供全双工通信；面向字节流
* TCP用主机的IP地址加上主机上的端口号作为TCP连接的端点。这样的端点叫做套接字或者插口，它用(IP地址:端口号)表示
* 停止等待协议能够在不可靠的传输网络上实现可靠的通信。每发送完一个分组就停止发送，等待对方的确认。在收到确认后再发送下一个分组。分组需要进行编号
* 超时重传只只要超过一段时间仍然没有收到确认，就重传前面发送过的分组。因此每发送完一个分组就需要设置一个超时计时器，其重传时间应比数据在分组传输的平均往返时间更长一些。这种自动重传方式称为自动重传请求ARQ
* 在停止等待协议中，若接收方收到重复分组，就丢弃该分组，但同时还要发送确认
* 连续ARQ协议可以提高信道利用率。发送方维持一个发送窗口，凡位于发送窗口内的分组都可连续发送出去，而不需要等待对方的确认。接收方一般采用累积确认，对按序到达的最后一个分组发送确认，表明到这个分组为止的所有分组都已正确接收
* TCP报文首部的前10个字节是固定的，后面有4N个字节是根据需要而增加的选项。在一个TCP连接中传送的字节流汇总的每一个字节都按顺序编号。首部中的序号字段则指本报文所发送的数据的第一个字节的序号
* TCP首部中的确认号是期望收到对方下一个报文段的第一个数据字节的序号。
* TCP首部中的窗口字段指出了现在允许对方发送的数据量。窗口值是经常在动态变化着的
* TCP使用滑动窗口机制。发送窗口里面的序号表示允许发送的序号。发送窗口后沿的后面部分表示已发送且已收到了确认，而发送窗口前沿的前面部分表示不允许发送的。发送窗口后沿的变化情况有两种，即不动(没有收到新的确认)和前移(收到了新的确认)。发送窗口前沿是不断向前移动的
* 流量控制就是让发送方的发送速率不要太快，要让接收方来得及接收
* 在某段时间，如果对网络中某一资源的需求超过了该资源所能提供的可用部分，网络的性能就要变坏，这种情况叫做拥塞。拥塞控制就是防止过多的数据注入到网络中，这样可以使网络中的路由器或链路不致过载
* 流量控制是一个端到端的问题，是接收端抑制发送端发送数据的速率，以便使接收端来得及接收。拥塞控制是一个全局性的过程，涉及到所有主机、路由器以及与降低网络传输性能有关的所有因素
* 为了进行拥塞控制，TCP的发送方要维持一个拥塞窗口cwnd的状态变量。拥塞窗口的大小取决于网络的拥塞程度，并且在动态的变化着。发送方让自己的发送窗口取为拥塞窗口和接收方的接收窗口中较小的一个
* TCP的拥塞控制采用了四种算法：慢开始、拥塞避免、快重传和快恢复。在网络层，也可以使路由器采用适当的分组丢弃策略以减少网络拥塞的发生
* 运输连接有三个阶段：连接建立、数据传送和连接释放
* 主动发起TCP连接建立的应用进程叫做客户，而被动等待连接建立的应用进程叫做服务器，待对方确认后就进入半关闭状态。当另一方也没有数据再发送时，则发送连接释放通知，对方确认后就完全关闭TCP连接
