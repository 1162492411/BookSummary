
# 存储器的层次结构

![存储器的层次结构](http://7xshpr.com1.z0.glb.clouddn.com/OperatingSystem-4-1.jpg)

# 程序的装入和连接
装入
* 绝对装入
* 可重定位装入
* 动态运行时装入

链接
* 静态链接
* 装入时动态链接
* 运行时动态链接

## 单一连续分配和回收
整个用户区仅装入一道应用程序


## 固定分区分配和回收

分配
* 将内存固定地划分为若干大小等的区域，分区一旦划分，在整个执行过程中每个分区的长度和内存的总分区个数保持不变
* 采用`静态地址重定位`
* 通过`分区说明表`对用户作业进行存储分配，分区说明表记录分区的序号、空间大小、起始地址和使用情况
* 当作业要求装入系统时，通过分区说明表查询合适的空闲分区，分配后更新空间分区的信息




## 动态分区分配和回收

分配
* 在系统初启时，除了操作系统常驻内存外，只有一个空闲分区，随后,分配程序将该区依次划分给调度中的作业或进程

### 动态分区分配算法
* 首次适应算法
  * 要求空闲区按首址递增的次序组织空闲区表
  * 申请时取最小可满足区域
* 最佳适应算法
  * 按空闲区大小从小到大的次序组成空闲区表
  * 申请时取最小可满足区域
* 最坏适应算法
  * 空闲区按大小递减的顺序组织空闲区表
  * 申请时取最大可满足区域
## 动态可重定位分区分配
  * 将内存中所有作业移到内存的一端,使本来分散的多个小空闲区连成一个大的空闲区
# 对换
`对换`是指将内存某部分的程序或数据写入外存交换区，再从外存交换区中调入指定的程序或数据到内存中的一种内存扩充技术
# 分页存储管理方式
## 分页管理的基本原理
将用户程序的地址空间划分为若干大小相等的区域，每个区域称为`页面`/`页`，每个页的编号称为`页号`

将内存空间划分为若干大小和页大小相同的物理块，这些物理块叫做`帧`/`内存块`，每个物理块的编号称为`物理块号`

以页为单位进行内存分配，并按作业的页数多少进行分配，逻辑上相邻的页物理上不一定相邻

分页系统中由CPU生成的每个地址分为两部分:高位表示页号，地位表示页偏移

为了找到每个页面在内存中对应的物理块，系统为每个进程设置了一张`页面映射表`，简称`页表`，页表的作用是根据页号找到其对应的物理块号，完成从页号到物理块号的地址映射

## 地址映射
![地址映射](http://7xshpr.com1.z0.glb.clouddn.com/OperatingSystem-4-2.jpg)
## 快表和联想寄存器
由于通过页表才能获取实际的物理地址，因此指令执行时需要先访问页表才能访问实际的物理地址，为了加快指令的执行速度，引入`快表`的概念，将页表放在一组快速存储器中，相对的，放在内存中的页表称为`慢表`，快表又称`联想存储器`

## 两级和多级页表
当页表过多时，将页表分成一张张小页表(称为页表页)，将页表页放入一张`页目录表`，这样逻辑地址由三部分组成 : 页目录、页表页、位移

# 分段存储管理方式
## 分段管理的基本原理
将程序划分为若干段，每段有段号和段名，段内地址连续

逻辑地址由两部分组成 : `段号、段内地址`

内存被动态划分为若干段长度不同的`物理段`

以段为单位分配内存，每段在内存中占据连续空间

## 地址映射
每段在内存中设置了`段映射表`，简称`段表`，记录每个作业的大小和首址

进行地址映射时首先检查逻辑地址的段号是否合理，然后检查段内地址是否合理，短号不合理抛出越界中断

## 分段和分页的比较
* 页是信息的物理单位，段是信息的逻辑单位
* 页的大小由系统决定，段的大小由用户程序动态决定
* 分页的进程地址是单一的线性空间，分段的进程地址由段号和段内地址两部分组成

# 段页式存储管理
## 基本思想
作业地址空间进行段式管理，每段进行分页，内存空间划分为若干个和页大小相同的物理块，作业的逻辑地址由三部分组成  :段号、页号、页内位移。设置了段表和页表
