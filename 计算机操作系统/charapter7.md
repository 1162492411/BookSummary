

# 文件和文件系统

## 文件的定义
`文件`是具有标识符的相关字符流的集合

## 文件的分类

* 按照**用途**分类
  * 系统文件
  * 库文件
  * 用户文件
* 按照**文件的操作保护**分类
  * 只读文件
  * 读写文件
  * 只执行文件
* 按照**文件的性质**分类
  * 普通文件
  * 目录文件
  * 特别文件

## 文件系统的层次结构
`文件系统`是操作系统中负责存取和管理信息的模块，它由管理文件所需的数据结构(如文件控制块及存储分配表)和相应的管理软件以及访问文件的一组操作组成

## 文件系统的功能
* 使用户可执行创建、修改、删除读写文件的命令
* 使用户能够共享其他用户的文件
* 使用户能以合适的方式构造其他文件
* 使用户能够在文件间进行数据传输的命令
* 为了实现**按名存取**
* 为了防止意外事故
* 提供可靠的保护和保密措施

## Windows的主流文件系统
* FAT16
* FAT32
* NTFS

# 文件的逻辑结构
从用户角度观察到的文件的组织形式分为`有结构的文件`和`无结构的流式文件`

文件有两种结构:`逻辑结构`和`物理记录`

## 记录式文件
记录式文件又分为`定长记录文件`和`不定长记录文件`

## 流式文件
`流式文件`是无结构的文件，文件内部是一组相关信息组成的有序字节流

# 文件目录
`文件目录`是一种数据结构，用来标识文件系统中的文件及其物理地址，OS通过文件目录来组织文件

文件目录的组成
* 文件名
* 文件类型
* 文件的物理位置
* 文件的大小
* 保护信息
* 使用计数
* 时间和日期

## 文件控制块和索引结点
文件目录信息也叫做`文件控制块FCB`，FCB的有序集合叫做`文件目录`，通常将文件目录以文件的形式保存，叫做`目录文件`

文件描述信息单独形成一个称为`索引结点`的数据结构

## 简单的文件目录
为了方便用户的使用，需要对系统内的所有文件目录进行组织，常见的组织方式有
* 单级文件目录
* 两级文件目录
* 树形结构目录

### 单级文件目录
所有文件登记在同一目录中

### 两级文件目录
将目录分为两级 : 第一级称为`主文件目录MFD`，给出用户名；第二级称为`用户文件目录UFD`，给出该用户的所有FCB
### 树形结构目录
主目录就是树根，称为`根目录`，每一个树枝结点就是一个`子目录`，各子目录间用斜线隔开，子目录名组成的部分称为`路径名`，路径名分为绝对路径名和相对路径名

### 目录查询技术
* 线性检索法
* Hash方法

# 文件共享
`文件共享`是指允许多个用户或进程共享同一个文件，从而避免同一个文件保存为多份造成的空间浪费

文件共享的方式
* 采用文件全名访问
* 基于有向无循环图实现
* 利用符号链实现

# 文件保护

* 对用户分类
  * 按照对文件的访问权力将用户分类，然后对每个文件规定各类用户的存取权限
  * 用户分为 : 文件主、文件主的同组用户或合作用户、其他用户
* 对访问权限分类
  * 仅允许合法用户访问
  * 文件的权限一般分为RWEAU
