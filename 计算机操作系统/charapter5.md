
# 虚拟存储器概述

## 常规存储管理方式的特征和局部性原理
特征
* 一次性
* 驻留性

`局部性原理`是程序在执行时呈现出**局部性规律**，即在一较短时间内，程序的执行仅限于某个部分

## 虚拟内存的定义和特征
`虚拟内存`是指在具有层次结构存储器的OS中，采用自动实现部分装入和部分对换功能，为用户提供一个比物理主存容量大得多的可寻址的一种“主存储器”

虚拟存储器实质是将用户地址空间和实际的存储空间区分开，它的容量主要受`指令中表示地址的字长`和`外存的容量`的限制

特征
* 虚拟性
* 部分装入
* 对换性

## 虚拟存储器的实现方法
* 分页请求系统
* 请求分段系统
# 请求分页技术存储管理方式
## 基本思想
进程开始时装入一个或零个页面，之后根据进程运行的需要动态装入其他页面；当内存已满又需要装入新页面时置换新页面

请求分页需要解决以下三个问题
* 系统如何获知进程当前所需页面不在主存-->请求页表机制
* 发现缺页时如何将所缺页面调入内存-->缺页中断
* 当内存已满又需要调入新页面时如何选择待淘汰的页面-->页面置换算法

### 请求页表机制
页号、块号、状态位、访问字段、修改位、外存地址
### 缺页中断机制
![缺页中断](http://7xshpr.com1.z0.glb.clouddn.com/QQ%E6%88%AA%E5%9B%BE20170531150002.jpg)
### 页面置换过程
![页面置换算法](http://7xshpr.com1.z0.glb.clouddn.com/OperatingSystem-5-2.jpg)

### 地址变换机制
调页+基本分页地址映射过程
## 请求分页中的内存分配

最小物理块数的确定 : 由指令集结构确定

内存分配策略
* 固定分配才策略分配给进程的内存块数在最初装入时被确定
* 可变分配策略分配给进程的内存随进程的活动而变化
* 页面置换范围
  * 全局置换允许一个进程从全体存储块的集合中选取淘汰块
  * 局部置换只允许一个进程从分配给他的一组内存块中选取淘汰块
  * 固定分配局部置换
  * 可变分配全局置换
  * 可变分配局部置换
* 物理块分配
  * 在采取固定分配策略时，可以采用以下几种算法 : 平均分配算法、按比例分配算法、考虑优先权的分配算法
## 页面调入策略

何时调入页面
* 预调页策略
* 请求调页策略

从何处调入页面
* 有足够的对换空间
* 缺少足够的对换空间
* unix方式

> 缺页率 = 缺页次数 / 总的页面访问次数 * 100 %



# 页面置换算法
选择页面置换算法的原则是保证系统的缺页次数最少
## 最佳置换算法OPT
淘汰在内存中最远时间内访问的页面，通常可保证最低的缺页率
## 先进先出页面置换算法FIFO
淘汰最先进入内存的页面
## 最近最久未使用算法LRU
淘汰最近一段时间内最久没有使用过的页面
## LRU近似算法
### 附加引位算法
### 第二次机会置换法
### 改进型二次机会置换法
# 抖动与工作集
在虚存中，页面在内存和外存之间频繁调度，导致系统效率急剧下降的现象称为`抖动`，原因是页面淘汰算法不合理/分配给进程的物理页面数太少

# 请求分段存储管理方式
请求分段中的硬件支持
* 请求段表机制
* 缺段中断机制
* 地址变换机制


分段的共享和保护
* 共享段表
* 共享段的分配和回收
